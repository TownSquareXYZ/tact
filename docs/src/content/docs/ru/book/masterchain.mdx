---
title: Мастерчейн
description: В блокчейне TON специальная цепочка, называемая мастерчейн, используется для синхронизации маршрутизации сообщений и выполнения транзакций, так что узлы в сети могут фиксировать определенную точку в состоянии мультичейна и достигать консенсуса относительно этого состояния
---

:::caution

  Адреса мастерчейна считаются недействительными, если параметр `masterchain` в [файле конфигурации](/ru/book/config) не имеет значения `true{:json}`.

:::

В блокчейне TON специальная цепочка, называемая ["мастерчейн"](https://docs.ton.org/learn/overviews/ton-blockchain#masterchain-blockchain-of-blockchains), используется для синхронизации маршрутизации сообщений и выполнения транзакций, чтобы узлы в сети могли зафиксировать определенную точку в состоянии мультичейна и достичь консенсуса относительно этого состояния.

Мастерчейн хранит [конфигурацию сети](/ru/ref/core-advanced#getconfigparam) и конечное состояние всех [воркчейнов](https://docs.ton.org/learn/overviews/ton-blockchain#workchain-blockchain-with-your-own-rules). Он содержит основную информацию о протоколе, включая текущие настройки, список активных валидаторов и их доли, активные воркчейны и связанные с ними [шардчейны](https://docs.ton.org/develop/blockchain/shards). Но что самое важное, он сохраняет записи последних хэшей блоков для всех воркчейнов и шардчейнов, обеспечивая консенсус во всей сети.

## Как контракт защищен от мастерчейна {#protection}

Tact обязывает все контракты использовать [бейсчейн](https://docs.ton.org/develop/blockchain/shards), который является воркчейном по умолчанию с ID $0$. Это делается для того, чтобы предотвратить использование адресов мастерчейна в контракте.

Любые попытки указать на мастерчейн или иным образом взаимодействовать с ним без [включения поддержки мастерчейна](#support) приводят к исключению с [exit code 137](/ru/book/exit-codes#137): `Masterchain support is not enabled for this contract`.

То есть случайные развертывания в мастерчейне, получение сообщений от учетных записей мастерчейна, отправка сообщений на такие учетные записи и использование адресов мастерчейна или его идентификатора цепочки ($-1$) по умолчанию запрещены.

## Включение поддержки мастерчейна в параметрах компиляции {#support}

:::caution

Большинству контрактов не требуется развертывание в мастерчейне или какое-либо взаимодействие в нем. Это связано с тем, что мастерчейн в основном используется для голосования или хранения библиотек. Если вам не нужно участвовать в этих вещах, вам не нужно включать поддержку мастерчейна.

:::

Если вам действительно нужна поддержка мастерчейна, самый простой и рекомендуемый подход — изменить файл [`tact.config.json`](/ru/book/config) в корне вашего проекта (или создать его, если он еще не существует) и [установить свойство `masterchain` в `true{:json}`](/ru/book/config#options-masterchain).

Если вы работаете над проектом на основе [Blueprint][bp], вы можете включить поддержку мастерчейна в конфигурациях компиляции ваших контрактов, которые находятся в каталоге с именем `wrappers/`:

```typescript title="wrappers/YourContractName.compile.ts" {7}
import { CompilerConfig } from '@ton/blueprint';

export const compile: CompilerConfig = {
  lang: 'tact',
  target: 'contracts/your_contract_name.tact',
  options: {
    masterchain: true, // ← вот эта вещь!
  }
};
```

Однако [`tact.config.json`](/ru/book/config) все еще может использоваться в проектах [Blueprint][bp]. В таких случаях значения, указанные в [`tact.config.json`](/ru/book/config), действуют по умолчанию, если они не изменены в `wrappers/`.

:::note

  Если для параметра `separateCompilables` задано значение `true{:typescript}` в [`blueprint.config.ts`][bp-config], то файлы `.compile.ts` будут расположены в каталоге `compilables/`, а **не** в `wrappers/`.

:::

[bp]: https://github.com/ton-org/blueprint
[bp-config]: https://github.com/ton-org/blueprint/tree/main?tab=readme-ov-file#configuration
